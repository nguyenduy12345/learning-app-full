import{c as d,r as O,g as U,j as s,G as K,U as q,u as V,L as M,i as C,a as E}from"./index-DOHiL2hy.js";import{u as Z}from"./index.esm-DTng5uxP.js";var T={},k={},B={},P={},F={};Object.defineProperty(F,"__esModule",{value:!0});F.createScriptEle=void 0;const W=(e,c)=>new Promise(r=>{var a;const n=document.getElementsByTagName("script")[0];if(document.getElementById(e)){r(void 0);return}const o=document.createElement("script");if(o.id=e,o.src=c,o.onload=r,n)(a=n.parentNode)===null||a===void 0||a.insertBefore(o,n);else{const i=document.body.childNodes;document.body.insertBefore(o,i.item(i.length-1))}});F.createScriptEle=W;var A={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.paramsToObject=e.objectToParams=e.isObject=void 0;const c=t=>Object.prototype.toString.call(t)==="[object Object]";e.isObject=c;const r=t=>!(0,e.isObject)(t)||Object.keys(t).length===0?"":"?"+Object.keys(t).map(n=>`${n}=${encodeURIComponent(t[n])}`).join("&");e.objectToParams=r;const a=t=>(t==null?void 0:t.replace(/^\?/,"").split("&").reduce((n,o)=>{if(!o)return n;const[i,l]=o.split("=");return Object.assign(Object.assign({},n),{[i]:decodeURIComponent(l)})},{}))||{};e.paramsToObject=a})(A);var L={};Object.defineProperty(L,"__esModule",{value:!0});L.isFacebookApp=void 0;const Q=()=>{if(typeof window>"u")return!1;const e=navigator.userAgent||navigator.vendor||window.opera;return e.indexOf("FBAN")>-1||e.indexOf("FBAV")>-1||e.indexOf("Instagram")>-1};L.isFacebookApp=Q;(function(e){var c=d&&d.__createBinding||(Object.create?function(a,t,n,o){o===void 0&&(o=n);var i=Object.getOwnPropertyDescriptor(t,n);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(a,o,i)}:function(a,t,n,o){o===void 0&&(o=n),a[o]=t[n]}),r=d&&d.__exportStar||function(a,t){for(var n in a)n!=="default"&&!Object.prototype.hasOwnProperty.call(t,n)&&c(t,a,n)};Object.defineProperty(e,"__esModule",{value:!0}),r(F,e),r(A,e),r(L,e)})(P);(function(e){var c=d&&d.__awaiter||function(t,n,o,i){function l(u){return u instanceof o?u:new o(function(p){p(u)})}return new(o||(o=Promise))(function(u,p){function j(f){try{w(i.next(f))}catch(_){p(_)}}function x(f){try{w(i.throw(f))}catch(_){p(_)}}function w(f){f.done?u(f.value):l(f.value).then(j,x)}w((i=i.apply(t,n||[])).next())})},r=d&&d.__rest||function(t,n){var o={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&n.indexOf(i)<0&&(o[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var l=0,i=Object.getOwnPropertySymbols(t);l<i.length;l++)n.indexOf(i[l])<0&&Object.prototype.propertyIsEnumerable.call(t,i[l])&&(o[i[l]]=t[i[l]]);return o};Object.defineProperty(e,"__esModule",{value:!0}),e.FacebookLoginClient=e.SDK_SCRIPT_ELE_ID=void 0;const a=P;e.SDK_SCRIPT_ELE_ID="facebook-jssdk",e.FacebookLoginClient={getFB:()=>window.FB?window.FB:(console.warn("FB not found"),null),getLoginStatus(t,n=!1){const o=this.getFB();if(!o){t({status:"unknown"});return}o.getLoginStatus(t,n)},getProfile(t,n){var o;(o=this.getFB())===null||o===void 0||o.api("me",n,t)},init(t){var n;(n=this.getFB())===null||n===void 0||n.init(t)},clear(){window.FB=null;const t=document.getElementById(e.SDK_SCRIPT_ELE_ID);t&&t.remove()},isRedirected(t){var n,o;const i=(0,a.paramsToObject)(window.location.search);return((n=i.state===(t==null?void 0:t.state))!==null&&n!==void 0?n:"facebookdirect")&&i[(o=t==null?void 0:t.response_type)!==null&&o!==void 0?o:""]!==void 0},loadSdk(t,n){return c(this,void 0,void 0,function*(){yield(0,a.createScriptEle)(e.SDK_SCRIPT_ELE_ID,`https://connect.facebook.net/${t}/sdk${n?"/xfbml.customerchat":""}.js`)})},redirectToDialog(t,n){var o=r(n,["ignoreSdkError"]);window.location.href=`https://www.facebook.com/dialog/oauth${(0,a.objectToParams)(Object.assign(Object.assign({},t),o))}`},login(t,n){var o,{ignoreSdkError:i}=n,l=r(n,["ignoreSdkError"]);try{(o=this.getFB())===null||o===void 0||o.login(t,l)}catch(u){if(i)return;throw u}},logout(t){this.getLoginStatus(n=>{var o;n.status==="connected"?(o=this.getFB())===null||o===void 0||o.logout(t):t()})}}})(B);var H=d&&d.__createBinding||(Object.create?function(e,c,r,a){a===void 0&&(a=r);var t=Object.getOwnPropertyDescriptor(c,r);(!t||("get"in t?!c.__esModule:t.writable||t.configurable))&&(t={enumerable:!0,get:function(){return c[r]}}),Object.defineProperty(e,a,t)}:function(e,c,r,a){a===void 0&&(a=r),e[a]=c[r]}),J=d&&d.__setModuleDefault||(Object.create?function(e,c){Object.defineProperty(e,"default",{enumerable:!0,value:c})}:function(e,c){e.default=c}),X=d&&d.__importStar||function(e){if(e&&e.__esModule)return e;var c={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&H(c,e,r);return J(c,e),c},Y=d&&d.__awaiter||function(e,c,r,a){function t(n){return n instanceof r?n:new r(function(o){o(n)})}return new(r||(r=Promise))(function(n,o){function i(p){try{u(a.next(p))}catch(j){o(j)}}function l(p){try{u(a.throw(p))}catch(j){o(j)}}function u(p){p.done?n(p.value):t(p.value).then(i,l)}u((a=a.apply(e,c||[])).next())})};Object.defineProperty(k,"__esModule",{value:!0});const I=X(O),y=B,ee=P;function te(e){var c,r;const{appId:a,language:t="en_US",scope:n="public_profile, email",fields:o="name,email,picture",onSuccess:i,onFail:l,onProfileSuccess:u,className:p,style:j,children:x="Login with Facebook",render:w,autoLoad:f=!1,useRedirect:_=!1,useCustomerChat:v=!1}=e,b=Object.assign(Object.assign({version:"v16.0",xfbml:!1,cookie:!1,localStorage:!0},e.initParams),{appId:a}),m=Object.assign(Object.assign({redirect_uri:typeof window<"u"?location.origin+location.pathname:"/",state:"facebookdirect",response_type:"code"},e.dialogParams),{client_id:a}),g=Object.assign(Object.assign({return_scopes:!1,ignoreSdkError:!1},e.loginOptions),{auth_nonce:typeof((c=e.loginOptions)===null||c===void 0?void 0:c.auth_nonce)=="function"?e.loginOptions.auth_nonce():(r=e.loginOptions)===null||r===void 0?void 0:r.auth_nonce,scope:n});(0,I.useEffect)(()=>{h()},[]);const h=()=>Y(this,void 0,void 0,function*(){yield y.FacebookLoginClient.loadSdk(t,v),window.fbAsyncInit=()=>{y.FacebookLoginClient.init(b);const S=y.FacebookLoginClient.isRedirected(m);if(S===!1&&f){N();return}S===!0&&_&&D()}}),D=()=>{y.FacebookLoginClient.login(S=>{if(!S.authResponse){l&&l({status:"loginCancelled"});return}i&&i(S.authResponse),u&&y.FacebookLoginClient.getProfile(u,{fields:o})},Object.assign(Object.assign({},g),{scope:n}))},N=()=>{if((0,ee.isFacebookApp)()||_){y.FacebookLoginClient.redirectToDialog(m,g);return}if(!window.FB){l&&l({status:"facebookNotLoaded"});return}D()};return w?w({onClick:N,logout:y.FacebookLoginClient.logout}):I.default.createElement("button",{type:"button",onClick:N,className:p,style:j},x)}k.default=te;var R={},$={};Object.defineProperty($,"__esModule",{value:!0});var z={};Object.defineProperty(z,"__esModule",{value:!0});var G={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.LoginStatus=void 0,function(c){c.Connected="connected",c.NotAuthorized="not_authorized",c.Unknown="unknown"}(e.LoginStatus||(e.LoginStatus={}))})(G);(function(e){var c=d&&d.__createBinding||(Object.create?function(a,t,n,o){o===void 0&&(o=n);var i=Object.getOwnPropertyDescriptor(t,n);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(a,o,i)}:function(a,t,n,o){o===void 0&&(o=n),a[o]=t[n]}),r=d&&d.__exportStar||function(a,t){for(var n in a)n!=="default"&&!Object.prototype.hasOwnProperty.call(t,n)&&c(t,a,n)};Object.defineProperty(e,"__esModule",{value:!0}),r($,e),r(z,e),r(G,e)})(R);(function(e){var c=d&&d.__createBinding||(Object.create?function(n,o,i,l){l===void 0&&(l=i);var u=Object.getOwnPropertyDescriptor(o,i);(!u||("get"in u?!o.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return o[i]}}),Object.defineProperty(n,l,u)}:function(n,o,i,l){l===void 0&&(l=i),n[l]=o[i]}),r=d&&d.__exportStar||function(n,o){for(var i in n)i!=="default"&&!Object.prototype.hasOwnProperty.call(o,i)&&c(o,n,i)},a=d&&d.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(e,"__esModule",{value:!0});const t=a(k);r(P,e),r(R,e),r(k,e),r(B,e),e.default=t.default})(T);const ne=U(T),oe=({handleLoginWithFacebook:e})=>{const c=a=>{e(a)};return s.jsx(ne,{appId:"581032447867843",autoLoad:!0,onSuccess:a=>{c(a)},fields:"name,email,picture",scope:"public_profile, email",render:a=>s.jsxs("div",{onClick:a.onClick,className:"mt-1 flex cursor-pointer bg-[#8b8fde] p-3 font-medium text-white hover:text-black",children:[s.jsx("img",{src:"images/logo/facebook.webp",className:"mr-2 h-6 w-6 font-noto"}),s.jsx("p",{className:"text-center w-full",children:"Đăng nhập bằng Facebook"})]})})},ie=({handleLoginWithGoogle:e})=>{const c=r=>{e(r)};return s.jsx(K,{onSuccess:c,render:r=>s.jsxs("div",{onClick:r.onClick,className:"flex cursor-pointer justify-center bg-[#dfe8e7] p-3 font-noto font-medium hover:text-white md:mr-1 md:w-1/2",children:[s.jsx("img",{src:"images/logo/googlelogo.png",className:"lazyload mr-2 h-6 w-6"}),"Đăng nhập bằng Google"]})})},ce=()=>{const[e,c]=O.useState(!1),[r,a]=O.useState(!1),{profile:t}=O.useContext(q),n=V();O.useEffect(()=>{t&&n("/learning")},[t]);const{register:o,handleSubmit:i,setFocus:l,formState:{errors:u,isSubmitting:p}}=Z();O.useEffect(()=>{l("email")},[l]);const j=async f=>{var _,v;if(f)try{await C.post("login",f).then(b=>{var m,g,h;a((m=b==null?void 0:b.data)==null?void 0:m.message),E.set("token",(h=(g=b==null?void 0:b.data)==null?void 0:g.data)==null?void 0:h.accessToken,{expires:30}),b!=null&&b.data&&window.location.replace("/learning")})}catch(b){a((v=(_=b==null?void 0:b.response)==null?void 0:_.data)==null?void 0:v.message)}},x=async f=>{var _,v,b,m;try{const g=await C.post("facebook_login",{accessToken:f.accessToken});E.set("token",(v=(_=g==null?void 0:g.data)==null?void 0:_.data)==null?void 0:v.accessToken,{expires:30}),g!=null&&g.data&&window.location.replace("/learning")}catch(g){a((m=(b=g==null?void 0:g.response)==null?void 0:b.data)==null?void 0:m.message)}},w=async f=>{var _,v,b,m;try{const g=f==null?void 0:f.credential,h=await C.post("google_login",{token:g});E.set("token",(v=(_=h==null?void 0:h.data)==null?void 0:_.data)==null?void 0:v.accessToken,{expires:30}),h!=null&&h.data&&window.location.replace("/learning")}catch(g){a((m=(b=g==null?void 0:g.response)==null?void 0:b.data)==null?void 0:m.message)}};return s.jsx(s.Fragment,{children:s.jsx("div",{className:"flex h-screen w-full items-center justify-center bg-gradient-to-r from-pink-400 to-blue-600",children:s.jsxs("div",{className:"flex h-auto w-[35rem] flex-col bg-white p-6",children:[s.jsxs("div",{className:"mb-5 flex w-full",children:[s.jsx("img",{src:"/images/pngtree.png",className:"lazyload w-[8rem]"}),s.jsx("p",{className:"ml-3 flex items-center justify-center font-noto text-3xl font-bold",children:"Chào mừng bạn tới Duylingo"})]}),s.jsxs("form",{onSubmit:i(j),children:[s.jsx("input",{...o("email",{required:"Nhập email của bạn",validate:f=>f.match(/^\w+@[a-zA-Z_]+?\.[a-zA-Z]{2,3}$/)?!0:"Vui lòng nhập đúng email của bạn"}),type:"text",placeholder:"Email",name:"email",className:"mb-[1rem] w-full border border-inherit p-2 pl-3 font-noto outline-none"}),s.jsx("br",{}),u.email&&s.jsx("p",{className:"mb-2 text-red-500",children:u.email.message}),s.jsxs("div",{className:"relative",children:[s.jsx("input",{...o("password",{required:"Nhập mật khẩu của bạn",validate:f=>f.match(/^[A-Za-z0-9!@#$%^&*(),.?":{}|<>_-]+$/)?!0:"Vui lòng nhập mật khẩu của bạn"}),type:e?"text":"password",placeholder:"Mật khẩu",name:"password",className:"mb-[1rem] w-full border border-inherit p-2 pl-3 font-noto outline-none"}),e?s.jsx("i",{className:"fa-solid fa-eye-slash absolute right-3 top-3 cursor-pointer",onClick:()=>c(!e)}):s.jsx("i",{className:"fa-solid fa-eye absolute right-3 top-3 cursor-pointer",onClick:()=>c(!e)}),s.jsx("br",{}),u.password&&s.jsx("p",{className:"mb-2 text-red-500",children:u.password.message})]}),s.jsx("button",{className:"h-16 w-full bg-gradient-to-r from-pink-400 to-blue-600 p-2 text-2xl font-bold text-white hover:text-black",children:p?"Đang gửi...":"Đăng Nhập"}),r&&s.jsx("p",{className:"mt-1 w-full text-center font-noto text-xl text-red-500",children:r})]}),s.jsx(M,{to:"/forgot_password",className:"mt-[0.3rem] w-full cursor-pointer font-noto text-sky-500",children:"Quên mật khẩu?"}),s.jsxs("p",{className:"mt-2 font-noto",children:["Bạn chưa có đã có tài khoản?"," ",s.jsx(M,{to:"/register",className:"font-noto text-[1.1rem] font-bold text-blue-700",children:"Đăng Ký"})]}),s.jsxs("div",{className:"mt-4 w-full",children:[s.jsx(ie,{handleLoginWithGoogle:w}),s.jsx(oe,{handleLoginWithFacebook:x})]})]})})})};export{ce as default};
