import{r as m,U as $,b as _,d as C,u as P,e as k,j as t,O as D,i as w}from"./index-DOHiL2hy.js";import{M as L}from"./MainLayout-C2FnMJQz.js";import{S as z}from"./SideBar-Dvq9c2f6.js";const T=()=>{var c,g,p;const{courseOfLearningProcess:a,setCourseOfLearningProcess:b}=m.useContext($),{setIsLoading:f}=m.useContext(_),[r,j]=m.useState([]),[v,i]=m.useState(0);let[u,E]=C();const s=u.get("courseId")?u.get("courseId"):a?(c=a[0])==null?void 0:c.courseId._id:[],h=P(),N=k();m.useEffect(()=>{(async()=>{s&&N.pathname!=="/login"&&await w.get(`sections?courseId=${s}`).then(l=>{var d,n;j((n=(d=l==null?void 0:l.data)==null?void 0:d.data)==null?void 0:n.sections),f(!1)}).catch(l=>{f(!1)})})()},[s]);const y=async(e,l,d)=>{if(e.status===2||v===1)return;i(1);const n=a.findIndex(x=>x.courseId._id.toString()===s.toString());if(n<0){i(0);return}if(a[n].sections.findIndex(x=>x.sectionId.toString()===l.toString())>-1){h(`/learning/milestones?courseId=${s}&sectionId=${l}&index=${d}`),i(0);return}try{await w.patch("/learning_process/add_section",{courseId:s,sectionId:l}),h(`/learning/milestones?courseId=${s}&sectionId=${l}&index=${d}`),b(x=>{const o=[...x],S=o==null?void 0:o.findIndex(M=>s===M.courseId._id.toString());return o[S].sections.push({sectionId:l,totalMilestone:0,totalMilestoneDone:0,status:1,milestones:[]}),o}),i(0)}catch(x){return x}};r&&r.map(e=>{e.status=0,e.totalMilestone=0,e.totalMilestoneDone=0});const I=a==null?void 0:a.findIndex(e=>e.courseId._id.toString()===s.toString());return(p=(g=a[I])==null?void 0:g.sections)==null||p.forEach(e=>{const l=r.findIndex(d=>e.sectionId.toString()===d._id.toString());l>-1&&(r[l].status=e.status,r[l].totalMilestone=e.totalMilestone,r[l].totalMilestoneDone=e.totalMilestoneDone)}),t.jsx(t.Fragment,{children:t.jsx(L,{children:t.jsxs("div",{className:"mt-[5rem]",children:[t.jsx(D,{}),t.jsx("ul",{className:"flex w-full flex-grow flex-col gap-[1.5rem] px-[1rem] md:absolute md:left-[5.5rem] md:mt-4 md:w-[51vw] lg:left-[17rem] lg:w-[42vw] lg:px-[3rem] xl:w-[50vw] 2xl:w-[52vw] 2xl:px-[5rem]",children:r&&r.map((e,l)=>t.jsx("li",{onClick:()=>y(e,e==null?void 0:e._id,l),className:`md:h-[20rem] ${(e==null?void 0:e.status)===1||(e==null?void 0:e.status)===2?"bg-[#ddf4ff] lg:bg-[#ddf4ff]":"bg-[#f7f7f7]"} mx-auto h-[15rem] w-full cursor-pointer rounded-3xl border-[1px] border-gray-300 shadow-xl transition hover:shadow-2xl focus:scale-95 2xl:border-none`,children:t.jsxs("div",{className:"flex h-full w-full flex-col-reverse justify-between 2xl:flex-row",children:[t.jsxs("div",{className:`mt-2 flex h-[6rem] w-full flex-col justify-between bg-white px-5 py-3 md:px-6 md:py-2 2xl:mt-0 2xl:h-[90%] 2xl:w-[58%] 2xl:rounded-bl-3xl 2xl:rounded-tl-3xl 2xl:p-[2rem] ${(e==null?void 0:e.status)===1||(e==null?void 0:e.status)===2?"2xl:bg-[#ddf4ff]":"2xl:bg-[#f7f7f7]"} z-10 rounded-bl-3xl rounded-br-3xl`,children:[t.jsxs("div",{className:"",children:[t.jsx("span",{className:"font-noto text-xl font-medium text-[#5f5f5f] lg:text-3xl",children:`Phần ${l+1}`}),t.jsx("span",{className:"font-noto text-md font-medium text-[#5f5f5f] lg:text-xl",children:e.status===2?"- Hoàn thành":""}),(e==null?void 0:e.status)===1||(e==null?void 0:e.status)===2?t.jsxs("div",{className:"flex mt-1 2xl:mt-5 mx-auto w-[100%] items-center justify-center font-noto",children:[t.jsxs("div",{className:"relative h-4 w-full rounded-xl bg-[#f3d2d2] 2xl:bg-[#f9f9f9]",children:[t.jsx("div",{style:{width:`${e.totalMilestoneDone/e.totalMilestone*100}%`},className:"absolute z-10 top-[1px] h-[14px] rounded-xl bg-[#58cc02] transition ease-linear"}),t.jsx("span",{className:"absolute top-[0] left-[50%] -translate-x-1/2 text-xs font-medium text-[#b2afaf]",children:`${e.totalMilestoneDone} / ${e.totalMilestone}`})]}),t.jsx("div",{className:"relative ml-[0px] h-8 w-9 rounded-full bg-[#58cc02] p-[2px] border-[3px] border-white",children:t.jsx("div",{style:{clipPath:"polygon(50% 0%, 61% 35%, 98% 35%, 68% 57%, 79% 91%, 50% 70%, 21% 91%, 32% 57%, 2% 35%, 39% 35%)"},className:"absolute left-1/2 top-1/2 z-10 h-6 w-6 -translate-x-1/2 -translate-y-1/2 bg-white"})})]}):t.jsxs("div",{className:"mt-2 2xl:mt-4 ml-2 flex justify-between",children:[t.jsxs("div",{children:[t.jsx("i",{className:"fa-solid fa-lock"}),t.jsx("span",{className:"ml-2",children:" Đã bị khóa"})]}),t.jsxs("div",{className:"2xl:hidden border-[1px] border-green-500 px-4 py-1 rounded-lg text-sm hover:bg-[#b4ea81] border-b-[3px]",children:[t.jsx("i",{className:"fa-solid fa-lock-open"}),t.jsxs("span",{className:"ml-2",children:["Mở phần ",l+1]})]})]})]}),(e==null?void 0:e.status)===1?t.jsx("div",{className:"hidden 2xl:flex mx-auto h-[2rem] w-[50%] items-center justify-center rounded-lg bg-[#1cb0f6] px-2 font-noto text-lg font-bold text-white shadow-lg hover:bg-[#3181a5] hover:shadow-xl md:text-xl 2xl:h-[3rem] 2xl:w-full",children:"Tiếp tục"}):(e==null?void 0:e.status)===2?t.jsx("div",{className:"hidden 2xl:flex mx-auto h-[2rem] w-[50%] items-center justify-center rounded-lg bg-green-400 px-2 font-noto text-lg font-bold shadow-lg hover:shadow-xl md:text-2xl 2xl:h-[3rem] 2xl:w-full",children:"Hoàn thành"}):t.jsxs("div",{className:"hidden 2xl:flex mx-auto h-[2rem] w-[50%] items-center justify-center rounded-lg bg-[#eeeeee] px-2 font-noto text-lg font-bold shadow-lg hover:shadow-xl hover:text-green-400 md:text-xl 2xl:h-[3rem] 2xl:w-full",children:[t.jsx("i",{className:"fa-solid fa-lock-open"}),t.jsxs("span",{className:"ml-2",children:["Mở phần học ",l+1]})]})]}),t.jsxs("div",{className:"relative mt-7 2xl:w-[45%] flex-grow items-start justify-center overflow-hidden 2xl:flex 2xl:flex-col 2xl:pr-5",children:[t.jsxs("div",{className:"text-md relative mx-auto flex h-[60%] w-[90%] rounded-xl bg-white p-2 text-center font-noto font-medium text-[#4b4b4b] md:text-lg 2xl:h-[30%] 2xl:w-[95%]",children:[t.jsx("p",{className:"flex h-full w-full items-center justify-center text-center",children:e==null?void 0:e.name}),t.jsx("div",{style:{clipPath:"polygon(50% 0%, 0% 100%, 100% 100%)"},className:"absolute -bottom-[0.8rem] right-[3.3rem] h-6 w-6 rotate-[270deg] bg-white md:right-[5rem] 2xl:-bottom-[1rem] 2xl:right-[70%] 2xl:h-10 2xl:w-10"})]}),t.jsx("div",{className:"flex w-full justify-end 2xl:justify-center",children:t.jsx("img",{src:"/images/logo/pngtree-black-cat.png",className:"w-[6rem] md:w-[8rem] 2xl:w-[12rem] lazyload"})})]})]})},e==null?void 0:e._id))}),t.jsx(z,{})]})})})};export{T as default};
